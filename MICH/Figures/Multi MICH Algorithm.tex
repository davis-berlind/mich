\begin{algorithm}
\label{alg:mich-multi}
\caption{Variational Bayes Approximation to MICH Posterior for Mulivariate Mean Changes.}

\footnotesize
\SetAlgoLined
  Inputs: $\mathbf{y}_{1:T},\:\boldsymbol{\Lambda}_{1:T},\:L,\:\{\omega_\ell,\boldsymbol{\pi}_\ell\}_{\ell=1}^L;$ \\
  Initialize: $\boldsymbol{\mu}_0,\:\overline{\boldsymbol{\Theta}} := \{\overline{\boldsymbol{\theta}}_\ell\}_{\ell=1}^L$;
  
  \Repeat {Convergence} {
    \For{$\ell=1$ \KwTo $L$} {
      $\overline{\mathbf{r}}_{-\ell t} := \mathbf{y}_t -\boldsymbol{\mu}_0 - \sum_{\ell' \neq \ell}^L \E[\boldsymbol{\mu}_{\ell' t}]$ \tcp*{l\textsuperscript{th} partial mean residual}
      $\overline{\boldsymbol{\theta}}_\ell := \texttt{mean-scp}(\overline{\mathbf{r}}_{-\ell} \:;\: \boldsymbol{\Lambda}_{1:T}, \omega_{\ell}, \boldsymbol{\boldsymbol{\pi}}_{\ell})$ \tcp*{update mean parameters}
    }
    $\overline{\mathbf{r}}_{t} := \mathbf{y}_t- \sum_{\ell=1}^L \E[\boldsymbol{\mu}_{\ell t}]$ \tcp*{mean residual}
    $\boldsymbol{\mu}_0 :=\left(\sum_{t=1}^T\boldsymbol{\Lambda}_t\right)^{-1}\sum_{t=1}^T\boldsymbol{\Lambda}_t\overline{\mathbf{r}}_t $\tcp*{update intercept}
  }
  \Return{Posterior Parameters: $\overline{\boldsymbol{\Theta}}$}.
\end{algorithm}
